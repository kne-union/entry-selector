"use strict";(self.webpackChunk_kne_components_entry_selector=self.webpackChunk_kne_components_entry_selector||[]).push([[147,528],{71830:(e,t,l)=>{l.r(t),l.d(t,{default:()=>P});var r=l(94922),n=l.n(r),a=l(17096),s=l(20274),c=l(80816),i=l(63965),o=l(40772),d=l(7717),m=l(71952),p=l(54159),u=l.n(p),h=l(5599),f=l(55199),g=l(20046);l(16577),l(9062);function E(){return E=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var r in l)({}).hasOwnProperty.call(l,r)&&(e[r]=l[r])}return e},E.apply(null,arguments)}var y={"entry-selector":"_TIU4-","list-outer":"_ZXEhy","list-header":"_HAF3g","list-scroll":"_VO7i-",list:"_8w58c","list-lib":"_9m0I0","list-index":"_P8KYX","columns-control-content-list":"_agPfO","columns-control-content-item":"_iFzfk","is-drag":"_uB1q2","columns-control-content-item-icon":"_WHlyH","sortable-drag":"_dxhFH","sortable-ghost":"_7ZIH8"};const x=["onAdd","api","options","selectedTitle","listTitle","renderListTitle","renderSelectedItem","renderItem","renderOptions","getSearchProps","searchPlaceholder","maxScrollerHeight"],P=(0,s.createWithIntlProvider)({defaultLocale:"zh-CN",messages:{"zh-CN":{add:"\u6dfb\u52a0",selected:"\u5df2\u9009\u62e9",list:"\u5217\u8868",searchPlaceholder:"\u8bf7\u8f93\u5165\u5173\u952e\u5b57"},"en-US":{add:"Add",selected:"Selected",list:"List",searchPlaceholder:"Please input keyword"}},namespace:"entry-selector"})(e=>{let{onAdd:t,api:l,options:p,selectedTitle:P,listTitle:_,renderListTitle:b,renderSelectedItem:v,renderItem:N,renderOptions:S,getSearchProps:k,searchPlaceholder:A,maxScrollerHeight:C=800}=e,I=function(e,t){if(null==e)return{};var l={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;l[r]=e[r]}return l}(e,x);const[O,w]=(0,d.A)(I),[F,T]=(0,r.useState)({}),{formatMessage:j}=(0,s.useIntl)(),H=(0,r.useRef)(null),L=(0,r.useRef)(new Map);return n().createElement(f.Flex,{vertical:!0,gap:8,className:y["entry-selector"],style:{"--max-scroller-height":"".concat(C,"px")}},"function"===typeof t&&n().createElement(f.Flex,null,n().createElement(f.Button,{shape:"round",size:"small",type:"primary",onClick:()=>{t({fetchApi:H.current,value:O,onChange:w})}},j({id:"add"}))),n().createElement(m.h,E({},I,{completeTips:null,searchProps:F,getSearchProps:k,api:l,ref:H,className:y["list-scroll"],autoHide:!1,render:e=>{let{fetchApi:t,children:l}=e;const{data:r}=t,{pageData:s,totalCount:i}=Object.assign({},{pageData:[],totalCount:0},r);s.forEach(e=>{L.current.set(e.id,e)});const o=L.current,d=(O||[]).map(e=>Object.assign({},o.get(e.id)||e));return n().createElement(f.Row,{gutter:[12,12]},n().createElement(f.Col,{span:12},n().createElement("div",{className:y["list-outer"]},i>0&&n().createElement("div",{className:y["list-header"]},P||j({id:"selected"})),n().createElement(g.A,{className:y["list-scroll"],autoHide:!1},O&&O.length>0?n().createElement(f.List,{className:y.list,size:"small"},n().createElement(a.ReactSortable,{filter:".ignore-elements",dragClass:y["sortable-drag"],ghostClass:y["sortable-ghost"],forceFallback:!0,animation:300,delayOnTouchStart:!0,delay:2,list:d,setList:e=>{w(t=>{const l=new Map((t||[]).map(e=>[e.id,e]));return e.map(e=>{let{id:t}=e;return l.get(t)})})}},d.map((e,l)=>{const r=n().createElement("span",{className:"list-item-title"},e.title),a=new Map((O||[]).map(e=>[e.id,e]));return n().createElement(f.List.Item,{key:e.id,className:u()(y["columns-control-content-item"],y["is-drag"])},n().createElement(c.A,{className:y["columns-control-content-item-icon"]}),n().createElement("div",{className:y["list-index"]},l+1),n().createElement(f.Flex,{vertical:!0,flex:1},"function"===typeof v?v(a.get(e.id),{el:r,target:e,fetchApi:t,searchProps:F,setSearchProps:T,onChange:t=>w(l=>{const r=(l||[]).slice(0),n=r.findIndex(t=>{let{id:l}=t;return l===e.id}),a=r[n];return n>-1&&r.splice(n,1,Object.assign({},"function"===typeof t?t(a):t)),r})}):r))}))):n().createElement(f.Flex,{className:y.list,justify:"center",align:"center"},n().createElement(f.Empty,null))))),n().createElement(f.Col,{span:12},n().createElement("div",{className:y["list-outer"]},n().createElement(f.Flex,{className:y["list-header"],justify:"space-between"},n().createElement("div",{className:y["list-header-title"]},_||"function"===typeof b&&b({fetchApi:t,searchProps:F,setSearchProps:T})||j({id:"list"})),n().createElement("div",null,"function"===typeof k&&n().createElement(h.A,{size:"small",placeholder:A||j({id:"searchPlaceholder"}),value:F.searchText,onSearch:e=>{T(t=>Object.assign({},t,{searchText:e}))}}))),l)))}}),e=>{let{fetchApi:t,list:l}=e;return n().createElement(f.List,{className:u()(y.list,y["list-lib"]),size:"small",dataSource:l,renderItem:e=>{const l=n().createElement("span",{className:"list-item-title"},e.title),r="function"===typeof S?S(e,{searchProps:F,setSearchProps:T,fetchApi:t,options:p}):p;return n().createElement(f.List.Item,{key:e.id,onClick:()=>{w(t=>{const l=(t||[]).slice(0),r=l.findIndex(t=>{let{id:l}=t;return l===e.id});return r>-1?l.splice(r,1):l.push(Object.assign({},e)),l})}},n().createElement(f.Checkbox,{checked:(O||[]).findIndex(t=>{let{id:l}=t;return l===e.id})>-1}),n().createElement(f.Flex,{vertical:!0,flex:1},"function"===typeof N?N(e,{fetchApi:t,el:l,searchProps:F,setSearchProps:T}):l),r&&n().createElement(f.Flex,{flex:"0 0 50px",onClick:e=>{e.stopPropagation()}},n().createElement(o.Ay,{more:n().createElement(f.Button,{type:"link",icon:n().createElement(i.A,null)}),list:r})))}})}))})}}]);
//# sourceMappingURL=147.ae5c1edb.chunk.js.map