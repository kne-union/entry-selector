"use strict";(self.webpackChunk_kne_components_entry_selector=self.webpackChunk_kne_components_entry_selector||[]).push([[147,528],{71830:(e,t,l)=>{l.r(t),l.d(t,{default:()=>_});var n=l(94922),a=l.n(n),r=l(17096),s=l(20274),c=l(80816),i=l(63965),o=l(3359),d=l(7717),m=l(71952),u=l(54159),p=l.n(u),h=l(5599),f=l(55199),g=l(20046);l(16577),l(9062);function E(){return E=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var l=arguments[t];for(var n in l)({}).hasOwnProperty.call(l,n)&&(e[n]=l[n])}return e},E.apply(null,arguments)}var y={"entry-selector":"_TIU4-","list-outer":"_ZXEhy","list-header":"_HAF3g","list-scroll":"_VO7i-",list:"_8w58c","list-lib":"_9m0I0","list-index":"_P8KYX","columns-control-content-list":"_agPfO","columns-control-content-item":"_iFzfk","is-drag":"_uB1q2","columns-control-content-item-icon":"_WHlyH","sortable-drag":"_dxhFH","sortable-ghost":"_7ZIH8"};const x=["onAdd","api","options","renderSelectedItem","renderItem","renderOptions","getSearchProps","searchPlaceholder","maxScrollerHeight"],_=(0,s.createWithIntlProvider)({defaultLocale:"zh-CN",messages:{"zh-CN":{add:"\u6dfb\u52a0",selected:"\u5df2\u9009\u62e9",list:"\u5217\u8868",searchPlaceholder:"\u8bf7\u8f93\u5165\u5173\u952e\u5b57"},"en-US":{add:"Add",selected:"Selected",list:"List",searchPlaceholder:"Please input keyword"}},namespace:"entry-selector"})(e=>{let{onAdd:t,api:l,options:u,renderSelectedItem:_,renderItem:v,renderOptions:b,getSearchProps:N,searchPlaceholder:k,maxScrollerHeight:A=800}=e,C=function(e,t){if(null==e)return{};var l={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;l[n]=e[n]}return l}(e,x);const[P,I]=(0,d.A)(C),[S,O]=(0,n.useState)({}),{formatMessage:w}=(0,s.useIntl)(),F=(0,n.useRef)(null);return a().createElement(f.Flex,{vertical:!0,gap:8,className:y["entry-selector"],style:{"--max-scroller-height":"".concat(A,"px")}},"function"===typeof t&&a().createElement(f.Flex,null,a().createElement(f.Button,{shape:"round",size:"small",type:"primary",onClick:()=>{t({fetchApi:F.current,value:P,onChange:I})}},w({id:"add"}))),a().createElement(m.h,E({},C,{completeTips:null,searchProps:S,getSearchProps:N,api:l,ref:F,className:y["list-scroll"],autoHide:!1,render:e=>{let{fetchApi:t,children:l}=e;const{data:n}=t,{pageData:s,totalCount:i}=Object.assign({},{pageData:[],totalCount:0},n),o=new Map(s.map(e=>[e.id,e])),d=(P||[]).map(e=>{let{id:t}=e;return o.get(t)}).filter(e=>!!e);return a().createElement(f.Row,{gutter:[12,12]},a().createElement(f.Col,{span:i>0?12:24},a().createElement("div",{className:y["list-outer"]},i>0&&a().createElement("div",{className:y["list-header"]},w({id:"selected"})),a().createElement(g.A,{className:y["list-scroll"],autoHide:!1},P&&P.length>0?a().createElement(f.List,{className:y.list,size:"small"},a().createElement(r.ReactSortable,{filter:".ignore-elements",dragClass:y["sortable-drag"],ghostClass:y["sortable-ghost"],forceFallback:!0,animation:300,delayOnTouchStart:!0,delay:2,list:d,setList:e=>{I(t=>{const l=new Map((t||[]).map(e=>[e.id,e]));return e.map(e=>{let{id:t}=e;return l.get(t)})})}},(P||[]).map(e=>{let{id:t}=e;return o.get(t)}).filter(e=>!!e).map((e,l)=>{const n=a().createElement("span",{className:"list-item-title"},e.title),r=new Map((P||[]).map(e=>[e.id,e]));return a().createElement(f.List.Item,{key:e.id,className:p()(y["columns-control-content-item"],y["is-drag"])},a().createElement(c.A,{className:y["columns-control-content-item-icon"]}),a().createElement("div",{className:y["list-index"]},l+1),a().createElement(f.Flex,{vertical:!0,flex:1},"function"===typeof _?_(r.get(e.id),{el:n,target:e,fetchApi:t,onChange:e=>I(t=>{const l=(t||[]).slice(0),n=l.findIndex(t=>{let{id:l}=t;return l===e.id}),a=l[n];return n>-1&&l.splice(n,1,Object.assign({},"function"===typeof e?e(a):e)),l})}):n))}))):a().createElement(f.Flex,{className:y.list,justify:"center",align:"center"},a().createElement(f.Empty,null))))),i>0&&a().createElement(f.Col,{span:12},a().createElement("div",{className:y["list-outer"]},a().createElement(f.Flex,{className:y["list-header"],justify:"space-between"},a().createElement("div",{className:y["list-header-title"]},w({id:"list"})),a().createElement("div",null,"function"===typeof N&&a().createElement(h.A,{size:"small",placeholder:k||w({id:"searchPlaceholder"}),value:S.searchText,onSearch:e=>{O(t=>Object.assign({},t,{searchText:e}))}}))),l)))}}),e=>{let{fetchApi:t,list:l}=e;return a().createElement(f.List,{className:p()(y.list,y["list-lib"]),size:"small",dataSource:l,renderItem:e=>{const l=a().createElement("span",{className:"list-item-title"},e.title),n="function"===typeof b?b(e,{fetchApi:t,options:u}):u;return a().createElement(f.List.Item,{key:e.id,onClick:()=>{I(t=>{const l=(t||[]).slice(0),n=l.findIndex(t=>{let{id:l}=t;return l===e.id});return n>-1?l.splice(n,1):l.push({id:e.id}),l})}},a().createElement(f.Checkbox,{checked:(P||[]).findIndex(t=>{let{id:l}=t;return l===e.id})>-1}),a().createElement(f.Flex,{vertical:!0,flex:1},"function"===typeof v?v(e,{fetchApi:t,el:l}):l),n&&a().createElement(f.Flex,{flex:"0 0 50px",onClick:e=>{e.stopPropagation()}},a().createElement(o.Ay,{more:a().createElement(f.Button,{type:"link",icon:a().createElement(i.A,null)}),list:n})))}})}))})}}]);
//# sourceMappingURL=528.3993a5ae.chunk.js.map