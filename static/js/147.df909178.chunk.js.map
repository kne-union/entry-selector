{"version":3,"file":"static/js/147.df909178.chunk.js","mappings":"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","sources":["../../src/index.js","../../src/locale/zh-CN.js","../../src/locale/en-US.js"],"sourcesContent":["import React, { useRef, useState } from 'react';\nimport zhCn from './locale/zh-CN';\nimport enUS from './locale/en-US';\nimport { ReactSortable } from 'react-sortablejs';\nimport { createWithIntlProvider, useIntl } from '@kne/react-intl';\nimport { MoreOutlined, HolderOutlined } from '@ant-design/icons';\nimport ButtonGroup from '@kne/button-group';\nimport useControllerValue from '@kne/use-control-value';\nimport { FetchScrollLoader } from '@kne/scroll-loader';\nimport classnames from 'classnames';\nimport SearchInput from '@kne/search-input';\nimport { Flex, Button, Row, Col, List, Empty, Checkbox } from 'antd';\nimport SimpleBar from 'simplebar-react';\nimport 'simplebar/dist/simplebar.min.css';\nimport '@kne/button-group/dist/index.css';\nimport style from './style.module.scss';\n\nconst EntrySelector = createWithIntlProvider({\n  defaultLocale: 'zh-CN',\n  messages: {\n    'zh-CN': zhCn,\n    'en-US': enUS\n  },\n  namespace: 'entry-selector'\n})(({ onAdd, api, options, renderSelectedItem, renderItem, renderOptions, getSearchProps, searchPlaceholder, maxScrollerHeight = 800, ...props }) => {\n  const [value, onChange] = useControllerValue(props);\n  const [searchProps, setSearchProps] = useState({});\n  const { formatMessage } = useIntl();\n  const ref = useRef(null);\n  return (\n    <Flex\n      vertical\n      gap={8}\n      className={style['entry-selector']}\n      style={{\n        '--max-scroller-height': `${maxScrollerHeight}px`\n      }}\n    >\n      {typeof onAdd === 'function' && (\n        <Flex>\n          <Button\n            shape=\"round\"\n            size=\"small\"\n            type=\"primary\"\n            onClick={() => {\n              onAdd({ fetchApi: ref.current, value, onChange });\n            }}\n          >\n            {formatMessage({ id: 'add' })}\n          </Button>\n        </Flex>\n      )}\n      <FetchScrollLoader\n        {...props}\n        completeTips={null}\n        searchProps={searchProps}\n        getSearchProps={getSearchProps}\n        api={api}\n        ref={ref}\n        className={style['list-scroll']}\n        autoHide={false}\n        render={({ fetchApi, children }) => {\n          const { data } = fetchApi;\n          const { pageData, totalCount } = Object.assign(\n            {},\n            {\n              pageData: [],\n              totalCount: 0\n            },\n            data\n          );\n          const listMapping = new Map(pageData.map(item => [item.id, item]));\n          const currentList = (value || []).map(({ id }) => listMapping.get(id)).filter(item => !!item);\n          return (\n            <Row gutter={[12, 12]}>\n              <Col span={totalCount > 0 ? 12 : 24}>\n                <div className={style['list-outer']}>\n                  {totalCount > 0 && <div className={style['list-header']}>{formatMessage({ id: 'selected' })}</div>}\n                  <SimpleBar className={style['list-scroll']} autoHide={false}>\n                    {value && value.length > 0 ? (\n                      <List className={style['list']} size=\"small\">\n                        <ReactSortable\n                          filter=\".ignore-elements\"\n                          dragClass={style['sortable-drag']}\n                          ghostClass={style['sortable-ghost']}\n                          forceFallback\n                          animation={300}\n                          delayOnTouchStart\n                          delay={2}\n                          list={currentList}\n                          setList={list => {\n                            onChange(value => {\n                              const mapping = new Map((value || []).map(item => [item.id, item]));\n                              return list.map(({ id }) => {\n                                return mapping.get(id);\n                              });\n                            });\n                          }}\n                        >\n                          {(value || [])\n                            .map(({ id }) => listMapping.get(id))\n                            .filter(item => !!item)\n                            .map((item, index) => {\n                              const defaultItem = <span className={'list-item-title'}>{item.title}</span>;\n                              const mapping = new Map((value || []).map(item => [item.id, item]));\n                              return (\n                                <List.Item key={item.id} className={classnames(style['columns-control-content-item'], style['is-drag'])}>\n                                  <HolderOutlined className={style['columns-control-content-item-icon']} />\n                                  <div className={style['list-index']}>{index + 1}</div>\n                                  <Flex vertical flex={1}>\n                                    {typeof renderSelectedItem === 'function'\n                                      ? renderSelectedItem(mapping.get(item.id), {\n                                          el: defaultItem,\n                                          target: item,\n                                          fetchApi,\n                                          onChange: item => {\n                                            return onChange(value => {\n                                              const newValue = (value || []).slice(0);\n                                              const index = newValue.findIndex(({ id }) => id === item.id);\n                                              const currentItem = newValue[index];\n                                              if (index > -1) {\n                                                newValue.splice(index, 1, Object.assign({}, typeof item === 'function' ? item(currentItem) : item));\n                                              }\n                                              return newValue;\n                                            });\n                                          }\n                                        })\n                                      : defaultItem}\n                                  </Flex>\n                                </List.Item>\n                              );\n                            })}\n                        </ReactSortable>\n                      </List>\n                    ) : (\n                      <Flex className={style['list']} justify=\"center\" align=\"center\">\n                        <Empty />\n                      </Flex>\n                    )}\n                  </SimpleBar>\n                </div>\n              </Col>\n              {totalCount > 0 && (\n                <Col span={12}>\n                  <div className={style['list-outer']}>\n                    <Flex className={style['list-header']} justify=\"space-between\">\n                      <div className={style['list-header-title']}>{formatMessage({ id: 'list' })}</div>\n                      <div>\n                        {typeof getSearchProps === 'function' && (\n                          <SearchInput\n                            size=\"small\"\n                            placeholder={searchPlaceholder || formatMessage({ id: 'searchPlaceholder' })}\n                            value={searchProps.searchText}\n                            onSearch={value => {\n                              setSearchProps(searchProps => Object.assign({}, searchProps, { searchText: value }));\n                            }}\n                          />\n                        )}\n                      </div>\n                    </Flex>\n                    {children}\n                  </div>\n                </Col>\n              )}\n            </Row>\n          );\n        }}\n      >\n        {({ fetchApi, list }) => {\n          return (\n            <List\n              className={classnames(style['list'], style['list-lib'])}\n              size=\"small\"\n              dataSource={list}\n              renderItem={item => {\n                const defaultItem = <span className={'list-item-title'}>{item.title}</span>;\n                const targetOptions =\n                  typeof renderOptions === 'function'\n                    ? renderOptions(item, {\n                        fetchApi,\n                        options\n                      })\n                    : options;\n                return (\n                  <List.Item\n                    key={item.id}\n                    onClick={() => {\n                      onChange(value => {\n                        const newValue = (value || []).slice(0);\n                        const index = newValue.findIndex(({ id }) => id === item.id);\n                        if (index > -1) {\n                          newValue.splice(index, 1);\n                        } else {\n                          newValue.push({ id: item.id });\n                        }\n\n                        return newValue;\n                      });\n                    }}\n                  >\n                    <Checkbox checked={(value || []).findIndex(({ id }) => id === item.id) > -1} />\n                    <Flex vertical flex={1}>\n                      {typeof renderItem === 'function'\n                        ? renderItem(item, {\n                            fetchApi,\n                            el: defaultItem\n                          })\n                        : defaultItem}\n                    </Flex>\n                    {targetOptions && (\n                      <Flex\n                        flex={'0 0 50px'}\n                        onClick={e => {\n                          e.stopPropagation();\n                        }}\n                      >\n                        <ButtonGroup more={<Button type=\"link\" icon={<MoreOutlined />} />} list={targetOptions} />\n                      </Flex>\n                    )}\n                  </List.Item>\n                );\n              }}\n            />\n          );\n        }}\n      </FetchScrollLoader>\n    </Flex>\n  );\n});\n\nexport default EntrySelector;\n","const locale = {\n  add: '添加',\n  selected: '已选择',\n  list: '列表',\n  searchPlaceholder: '请输入关键字'\n};\n\nexport default locale;\n","const locale = {\n  add: 'Add',\n  selected: 'Selected',\n  list: 'List',\n  searchPlaceholder: 'Please input keyword'\n};\n\nexport default locale;\n"],"names":["EntrySelector","createWithIntlProvider","defaultLocale","messages","add","selected","list","searchPlaceholder","namespace","_ref","onAdd","api","options","renderSelectedItem","renderItem","renderOptions","getSearchProps","maxScrollerHeight","props","_objectWithoutPropertiesLoose","_excluded","value","onChange","useControllerValue","searchProps","setSearchProps","useState","formatMessage","useIntl","ref","useRef","React","Flex","vertical","gap","className","style","concat","Button","shape","size","type","onClick","fetchApi","current","id","FetchScrollLoader","_extends","completeTips","autoHide","render","_ref2","children","data","pageData","totalCount","Object","assign","listMapping","Map","map","item","currentList","_ref3","get","filter","Row","gutter","Col","span","SimpleBar","length","List","ReactSortable","dragClass","ghostClass","forceFallback","animation","delayOnTouchStart","delay","setList","mapping","_ref4","_ref5","index","defaultItem","title","Item","key","classnames","HolderOutlined","flex","el","target","newValue","slice","findIndex","_ref6","currentItem","splice","justify","align","Empty","SearchInput","placeholder","searchText","onSearch","_ref7","dataSource","targetOptions","_ref8","push","Checkbox","checked","_ref9","e","stopPropagation","ButtonGroup","more","icon","MoreOutlined"],"sourceRoot":""}